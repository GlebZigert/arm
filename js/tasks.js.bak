/*var New = Tasks
function Tasks() {
    timer = new Timer();
    timer.interval = 3e3;
    timer.repeat = false;
    timer.triggered.connect(function () {
        console.log("I'm triggered once every second");
    })
    timer.start();

    return this
}

*/

var timer,
    socket,
    taskId = 0;

function init(sock) {
    socket = sock
    timer = Qt.createQmlObject("import QtQuick 2.0; Timer {}", socket)
}

function newTask(service, action, data, done, fail) {
    var payload = JSON.stringify({service: service, action: action, task: ++taskId, data: data})
    console.log("[SEND]", payload)
    if (socket.active)
        //socket.sendTextMessage(payload)
    if (taskId%2)
        done()
    else
        fail()
}
